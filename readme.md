# ⚓ Морской бой — многопользовательская пошаговая игра

## Цель проекта

Создание простой браузерной игры для двух игроков, где каждый подключается по общему `secret_id`. После подключения оба видят статус "Подключение установлено", могут размещать корабли и участвовать в пошаговом морском бою. Игра сохраняет прогресс, а сессия восстанавливается при повторном входе.

---

## Стек технологий

| Компонент      | Технология        | Назначение                                  |
|----------------|-------------------|---------------------------------------------|
| Клиент         | HTML + Vanilla JS | UI, ввод `secret_id`, подключение по WebSocket |
| Сервер         | Node.js + Express | WebSocket-сервер, логика игры               |
| Связь          | WebSocket (`ws`)  | Реальное взаимодействие между игроками      |
| Хранилище      | JSON-файлы        | Состояние каждой сессии по `secret_id`      |
| Dev-tool       | `generate.js`     | Визуализация структуры проекта              |

---

## Структура проекта

```plaintext
project-root/
├── package.json             # Зависимости: express, ws
├── readme.md                # Описание проекта
├── public/
│   ├── index.html           # Ввод secret_id, интерфейс
│   ├── style.css            # Стили модального окна, UI
│   └── main.js              # Подключение и логика WebSocket-клиента
├── server/
│   ├── app.js               # WebSocket-сервер, логика подключения
│   ├── storage.js           # Работа с JSON-сессиями
│   ├── gameEngine.js        # Боевые действия (будет реализовано)
│   └── games/               # JSON-файлы сессий по `secret_id`
└── sys/
    ├── generate.js          # Скрипт генерации структуры проекта
    └── gen.txt              # Вывод структуры
Логика подключения игроков
Игрок вводит secret_id (строка длиной до 8 символов)

Клиент открывает WebSocket → отправляет { type: "connect", secret_id }

Сервер назначает свободную роль: player1 или player2

Если оба игрока подключены — сервер отсылает обоим { type: "connected" }

Если один — сервер отправляет { type: "waiting" }

Если обе роли заняты — клиент получает { type: "id_taken" }

После подключения — отображается Подключение установлено у обоих

JSON-сессия
Автоматически создаётся при подключении двух игроков

Сохраняется как server/games/<secret_id>.json

Структура:

json
{
  "players": {
    "player1": { "ships": [], "hits": [], "misses": [] },
    "player2": { "ships": [], "hits": [], "misses": [] }
  },
  "turn": "player1",
  "status": "setup"
}
Используется для восстановления игры и хранения состояния

WebSocket события
Клиент → Сервер	Назначение
connect	Инициализация соединения
place	Размещение кораблей (будет)
fire	Ход: выстрел
disconnect	Завершение сессии или выход
Сервер → Клиент	Назначение
role_assigned	Автоприсвоенная роль игрока
connected	Оба игрока в сессии
waiting	Ожидание второго игрока
id_taken	Сессия занята, вход невозможен
update	Обновление состояния игры

